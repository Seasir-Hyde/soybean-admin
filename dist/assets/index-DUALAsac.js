import{n as H,e as K,o as oe,_ as re,b as ue,u as ie,c as pe,p as me,q as de,g as ce,N as _e,h as ge,i as fe}from"./business-CTAS_vtJ.js";import{d as V,ar as z,as as L,a as J,$ as l,m as ve,r as he,aj as be,o as R,c as O,w as t,f as a,g as $,t as T,h as e,b as j,F as A,p as I,q as Q,at as X,N as B,av as Ne,aw as ye,a$ as q,H as Y,y as ke,ay as E,I as W,az as we}from"./index-CsZ02Qr7.js";import{u as Z,a as ee,_ as xe,b as ae}from"./form-BK7r1SgH.js";import{_ as le}from"./Space-B75Zs6g2.js";import{_ as Re,a as Se,b as Ue}from"./round-refresh-BlzXdacN.js";import{a as Ge}from"./Grid-fR6zBBla.js";const Pe=V({name:"UserOperateDrawer",__name:"user-operate-drawer",props:z({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:z(["submitted"],["update:visible"]),setup(h,{emit:G}){const _=h,w=G,g=L(h,"visible"),{formRef:N,validate:i,restoreValidation:P}=Z(),{defaultRequiredRule:y}=ee(),S=J(()=>({add:l("page.manage.user.addUser"),edit:l("page.manage.user.editUser")})[_.operateType]),o=ve(p());function p(){return{userName:"",userGender:null,nickName:"",userPhone:"",userEmail:"",userRoles:[],status:null}}const k={userName:y,status:y},d=he([]);async function U(){const{error:f,data:u}=await oe();if(!f){const v=u.map(n=>({label:n.roleName,value:n.roleCode})),s=o.userRoles.map(n=>({label:n,value:n}));d.value=[...s,...v]}}function b(){if(_.operateType==="add"){Object.assign(o,p());return}_.operateType==="edit"&&_.rowData&&Object.assign(o,_.rowData)}function x(){g.value=!1}async function D(){var f;await i(),(f=window.$message)==null||f.success(l("common.updateSuccess")),x(),w("submitted")}return be(g,()=>{g.value&&(b(),P(),U())}),(f,u)=>{const v=Q,s=xe,n=re,m=ue,F=X,M=ae,c=B,ne=le,te=Ne,se=ye;return R(),O(se,{show:g.value,"onUpdate:show":u[7]||(u[7]=r=>g.value=r),title:S.value,"display-directive":"show",width:360},{default:t(()=>[a(te,{title:S.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[a(ne,{size:16},{default:t(()=>[a(c,{onClick:x},{default:t(()=>[$(T(e(l)("common.cancel")),1)]),_:1}),a(c,{type:"primary",onClick:D},{default:t(()=>[$(T(e(l)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[a(M,{ref_key:"formRef",ref:N,model:o,rules:k},{default:t(()=>[a(s,{label:e(l)("page.manage.user.userName"),path:"userName"},{default:t(()=>[a(v,{value:o.userName,"onUpdate:value":u[0]||(u[0]=r=>o.userName=r),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userGender"),path:"userGender"},{default:t(()=>[a(m,{value:o.userGender,"onUpdate:value":u[1]||(u[1]=r=>o.userGender=r)},{default:t(()=>[(R(!0),j(A,null,I(e(H),r=>(R(),O(n,{key:r.value,value:r.value,label:e(l)(r.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.nickName"),path:"nickName"},{default:t(()=>[a(v,{value:o.nickName,"onUpdate:value":u[2]||(u[2]=r=>o.nickName=r),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userPhone"),path:"userPhone"},{default:t(()=>[a(v,{value:o.userPhone,"onUpdate:value":u[3]||(u[3]=r=>o.userPhone=r),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userEmail"),path:"email"},{default:t(()=>[a(v,{value:o.userEmail,"onUpdate:value":u[4]||(u[4]=r=>o.userEmail=r),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userStatus"),path:"status"},{default:t(()=>[a(m,{value:o.status,"onUpdate:value":u[5]||(u[5]=r=>o.status=r)},{default:t(()=>[(R(!0),j(A,null,I(e(K),r=>(R(),O(n,{key:r.value,value:r.value,label:e(l)(r.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userRole"),path:"roles"},{default:t(()=>[a(F,{value:o.userRoles,"onUpdate:value":u[6]||(u[6]=r=>o.userRoles=r),multiple:"",options:d.value,placeholder:e(l)("page.manage.user.form.userRole")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}}),De=V({name:"UserSearch",__name:"user-search",props:{model:{required:!0},modelModifiers:{}},emits:z(["reset","search"],["update:model"]),setup(h,{emit:G}){const _=G,{formRef:w,validate:g,restoreValidation:N}=Z(),i=L(h,"model"),P=J(()=>{const{patternRules:o}=ee();return{userEmail:o.email,userPhone:o.phone}});async function y(){await N(),_("reset")}async function S(){await g(),_("search")}return(o,p)=>{const k=Q,d=Re,U=X,b=Se,x=B,D=Ue,f=le,u=Ge,v=ae,s=Y;return R(),O(s,{title:e(l)("common.search"),bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[a(v,{ref_key:"formRef",ref:w,model:i.value,rules:P.value,"label-placement":"left","label-width":80},{default:t(()=>[a(u,{responsive:"screen","item-responsive":""},{default:t(()=>[a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userName"),path:"userName",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.userName,"onUpdate:value":p[0]||(p[0]=n=>i.value.userName=n),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userGender"),path:"userGender",class:"pr-24px"},{default:t(()=>[a(U,{value:i.value.userGender,"onUpdate:value":p[1]||(p[1]=n=>i.value.userGender=n),placeholder:e(l)("page.manage.user.form.userGender"),options:e(q)(e(H)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.nickName"),path:"nickName",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.nickName,"onUpdate:value":p[2]||(p[2]=n=>i.value.nickName=n),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userPhone"),path:"userPhone",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.userPhone,"onUpdate:value":p[3]||(p[3]=n=>i.value.userPhone=n),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userEmail"),path:"userEmail",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.userEmail,"onUpdate:value":p[4]||(p[4]=n=>i.value.userEmail=n),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userStatus"),path:"userStatus",class:"pr-24px"},{default:t(()=>[a(U,{value:i.value.status,"onUpdate:value":p[5]||(p[5]=n=>i.value.status=n),placeholder:e(l)("page.manage.user.form.userStatus"),options:e(q)(e(K)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(d,{span:"24 m:12",class:"pr-24px"},{default:t(()=>[a(f,{class:"w-full",justify:"end"},{default:t(()=>[a(x,{onClick:y},{icon:t(()=>[a(b,{class:"text-icon"})]),default:t(()=>[$(" "+T(e(l)("common.reset")),1)]),_:1}),a(x,{type:"primary",ghost:"",onClick:S},{icon:t(()=>[a(D,{class:"text-icon"})]),default:t(()=>[$(" "+T(e(l)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}}),Ee={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function C(h){return typeof h=="function"||Object.prototype.toString.call(h)==="[object Object]"&&!we(h)}const Me=V({name:"manage_user",__name:"index",setup(h){const G=ke(),{columns:_,columnChecks:w,data:g,getData:N,loading:i,mobilePagination:P,searchParams:y,resetSearchParams:S}=ie({apiFn:me,apiParams:{current:1,size:10,status:null,userName:null,userGender:null,nickName:null,userPhone:null,userEmail:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:l("common.index"),align:"center",width:64},{key:"userName",title:l("page.manage.user.userName"),align:"center",minWidth:100},{key:"userGender",title:l("page.manage.user.userGender"),align:"center",width:100,render:s=>{if(s.userGender===null)return null;const n={1:"primary",2:"error"},m=l(de[s.userGender]);return a(W,{type:n[s.userGender]},C(m)?m:{default:()=>[m]})}},{key:"nickName",title:l("page.manage.user.nickName"),align:"center",minWidth:100},{key:"userPhone",title:l("page.manage.user.userPhone"),align:"center",width:120},{key:"userEmail",title:l("page.manage.user.userEmail"),align:"center",minWidth:200},{key:"status",title:l("page.manage.user.userStatus"),align:"center",width:100,render:s=>{if(s.status===null)return null;const n={1:"success",2:"warning"},m=l(ce[s.status]);return a(W,{type:n[s.status]},C(m)?m:{default:()=>[m]})}},{key:"operate",title:l("common.operate"),align:"center",width:130,render:s=>{let n;return a("div",{class:"flex-center gap-8px"},[a(B,{type:"primary",ghost:!0,size:"small",onClick:()=>v(s.id)},C(n=l("common.edit"))?n:{default:()=>[n]}),a(_e,{onPositiveClick:()=>u(s.id)},{default:()=>l("common.confirmDelete"),trigger:()=>{let m;return a(B,{type:"error",ghost:!0,size:"small"},C(m=l("common.delete"))?m:{default:()=>[m]})}})])}}]}),{drawerVisible:o,operateType:p,editingData:k,handleAdd:d,handleEdit:U,checkedRowKeys:b,onBatchDeleted:x,onDeleted:D}=pe(g,N);async function f(){console.log(b.value),x()}function u(s){console.log(s),D()}function v(s){U(s)}return(s,n)=>{const m=ge,F=fe,M=Y;return R(),j("div",Ee,[a(De,{model:e(y),"onUpdate:model":n[0]||(n[0]=c=>E(y)?y.value=c:null),onReset:e(S),onSearch:e(N)},null,8,["model","onReset","onSearch"]),a(M,{title:e(l)("page.manage.user.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[a(m,{columns:e(w),"onUpdate:columns":n[1]||(n[1]=c=>E(w)?w.value=c:null),"disabled-delete":e(b).length===0,loading:e(i),onAdd:e(d),onDelete:f,onRefresh:e(N)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:t(()=>[a(F,{"checked-row-keys":e(b),"onUpdate:checkedRowKeys":n[2]||(n[2]=c=>E(b)?b.value=c:null),columns:e(_),data:e(g),size:"small","flex-height":!e(G).isMobile,"scroll-x":962,loading:e(i),remote:"","row-key":c=>c.id,pagination:e(P),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(Pe,{visible:e(o),"onUpdate:visible":n[3]||(n[3]=c=>E(o)?o.value=c:null),"operate-type":e(p),"row-data":e(k),onSubmitted:e(N)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{Me as default};
