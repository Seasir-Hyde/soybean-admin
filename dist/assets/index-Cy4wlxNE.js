import{m as ie,a as pe,e as me,_ as ce,b as de,u as ge,c as _e,f as ve,d as fe,g as ye,N as be,h as he,i as Te,j as Ne}from"./business-CTAS_vtJ.js";import{ap as Ie,aq as d,d as te,ar as Z,as as Oe,a as R,$ as e,m as we,f as a,_ as X,aj as Ee,o as v,c as b,w as i,g as ee,t as ae,h as t,b as x,F as q,p as G,O as L,q as Pe,at as ke,au as De,N as $,av as Re,aw as Le,y as Ae,ax as Me,r as V,ay as K,I as H,H as Ve,az as xe}from"./index-CsZ02Qr7.js";import{u as $e,a as Ce,_ as Ue,b as Se}from"./form-BK7r1SgH.js";import{_ as Be}from"./Space-B75Zs6g2.js";const ne={Y:"common.yesOrNo.yes",N:"common.yesOrNo.no"};Ie(ne);function je(){return Object.keys(Object.assign({"/src/assets/svg-icon/activity.svg":()=>d(()=>import("./activity-B4XY664I.js"),[],import.meta.url),"/src/assets/svg-icon/at-sign.svg":()=>d(()=>import("./at-sign-DvqQw7Qx.js"),[],import.meta.url),"/src/assets/svg-icon/avatar.svg":()=>d(()=>import("./avatar-xsrXzauM.js"),[],import.meta.url),"/src/assets/svg-icon/banner.svg":()=>d(()=>import("./banner-C4CadXPO.js"),[],import.meta.url),"/src/assets/svg-icon/cast.svg":()=>d(()=>import("./cast-n3EmpXB4.js"),[],import.meta.url),"/src/assets/svg-icon/chrome.svg":()=>d(()=>import("./chrome-BM_Le6p_.js"),[],import.meta.url),"/src/assets/svg-icon/copy.svg":()=>d(()=>import("./copy-BsYpLlfM.js"),[],import.meta.url),"/src/assets/svg-icon/custom-icon.svg":()=>d(()=>import("./custom-icon-857Ak5pp.js"),[],import.meta.url),"/src/assets/svg-icon/empty-data.svg":()=>d(()=>import("./empty-data-A2OD3csX.js"),[],import.meta.url),"/src/assets/svg-icon/expectation.svg":()=>d(()=>import("./expectation-BpMRrUTU.js"),[],import.meta.url),"/src/assets/svg-icon/heart.svg":()=>d(()=>import("./heart-DOH2U7VV.js"),[],import.meta.url),"/src/assets/svg-icon/logo.svg":()=>d(()=>import("./logo-BeLY4cv9.js"),[],import.meta.url),"/src/assets/svg-icon/network-error.svg":()=>d(()=>import("./network-error-BONdOo_S.js"),[],import.meta.url),"/src/assets/svg-icon/no-icon.svg":()=>d(()=>import("./no-icon-IH-GG0A5.js"),[],import.meta.url),"/src/assets/svg-icon/no-permission.svg":()=>d(()=>import("./no-permission-DlJ3fb-w.js"),[],import.meta.url),"/src/assets/svg-icon/not-found.svg":()=>d(()=>import("./not-found-CMFGzg-_.js"),[],import.meta.url),"/src/assets/svg-icon/service-error.svg":()=>d(()=>import("./service-error-fPdVTLT3.js"),[],import.meta.url),"/src/assets/svg-icon/wind.svg":()=>d(()=>import("./wind-Dy5zdHKW.js"),[],import.meta.url)})).map(m=>{var _;return((_=m.split("/").at(-1))==null?void 0:_.replace(".svg",""))||""}).filter(Boolean)}const C="layout.",U="view.",le="$";function Fe(p){let f="",m="";const[_,h]=(p==null?void 0:p.split(le))||[];return f=ze(_),m=We(h||_),{layout:f,page:m}}function ze(p){return p.startsWith(C)?p.replace(C,""):""}function We(p){return p.startsWith(U)?p.replace(U,""):""}function Ye(p,f){const m=!!p,_=!!f;return m&&_?`${C}${p}${le}${U}${f}`:m?`${C}${p}`:_?`${U}${f}`:""}const qe=te({name:"MenuOperateDrawer",__name:"menu-operate-drawer",props:Z({operateType:{},rowData:{},allPages:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:Z(["submitted"],["update:visible"]),setup(p,{emit:f}){const m=p,_=f,h=Oe(p,"visible"),{formRef:S,validate:B,restoreValidation:w}=$e(),{defaultRequiredRule:E}=Ce(),P=R(()=>({add:e("page.manage.menu.addMenu"),addChild:e("page.manage.menu.addChildMenu"),edit:e("page.manage.menu.editMenu")})[m.operateType]),n=we(T());function T(){return{menuType:"1",menuName:"",icon:"",iconType:"1",routeName:"",routePath:"",layout:"",page:"",status:null,hideInMenu:!1,order:0,parentId:0}}const N={userName:E,userStatus:E},j=R(()=>m.operateType==="edit"),I=je().map(c=>({label:()=>a("div",{class:"flex-y-center gap-16px"},[a(X,{localIcon:c,class:"text-icon"},null),a("span",null,[c])]),value:c})),F=R(()=>n.parentId===0),z=R(()=>n.menuType==="2"),W=R(()=>{const c=[...m.allPages];return n.routeName&&!c.includes(n.routeName)&&c.unshift(n.routeName),c.map(l=>({label:l,value:l}))}),k=[{label:"base",value:"base"},{label:"blank",value:"blank"}];function Y(){if(m.operateType==="add"){Object.assign(n,T());return}if(m.operateType==="addChild"&&m.rowData){const{id:c}=m.rowData;Object.assign(n,T(),{parentId:c})}if(m.operateType==="edit"&&m.rowData){const{component:c,...s}=m.rowData,{layout:l,page:r}=Fe(c);Object.assign(n,s,{layout:l,page:r})}}function A(){h.value=!1}async function M(){var c;await B(),n.component=Ye(n.layout,n.page),(c=window.$message)==null||c.success(e("common.updateSuccess")),A(),_("submitted")}return Ee(h,()=>{h.value&&(Y(),w())}),(c,s)=>{const l=ce,r=de,u=Ue,g=Pe,D=ke,y=De,oe=Se,Q=$,se=Be,ue=Re,re=Le;return v(),b(re,{show:h.value,"onUpdate:show":s[12]||(s[12]=o=>h.value=o),title:P.value,"display-directive":"show",width:360},{default:i(()=>[a(ue,{title:P.value,"native-scrollbar":!1,closable:""},{footer:i(()=>[a(se,{size:16},{default:i(()=>[a(Q,{onClick:A},{default:i(()=>[ee(ae(t(e)("common.cancel")),1)]),_:1}),a(Q,{type:"primary",onClick:M},{default:i(()=>[ee(ae(t(e)("common.confirm")),1)]),_:1})]),_:1})]),default:i(()=>[a(oe,{ref_key:"formRef",ref:S,model:n,rules:N,"label-placement":"left","label-width":80},{default:i(()=>[a(u,{label:t(e)("page.manage.menu.menuType"),path:"menuType"},{default:i(()=>[a(r,{value:n.menuType,"onUpdate:value":s[0]||(s[0]=o=>n.menuType=o),disabled:j.value},{default:i(()=>[(v(!0),x(q,null,G(t(ie),o=>(v(),b(l,{key:o.value,value:o.value,label:t(e)(o.label)},null,8,["value","label"]))),128))]),_:1},8,["value","disabled"])]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.menuName"),path:"menuName"},{default:i(()=>[a(g,{value:n.menuName,"onUpdate:value":s[1]||(s[1]=o=>n.menuName=o),placeholder:t(e)("page.manage.menu.form.menuName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.iconTypeTitle"),path:"iconType"},{default:i(()=>[a(r,{value:n.iconType,"onUpdate:value":s[2]||(s[2]=o=>n.iconType=o)},{default:i(()=>[(v(!0),x(q,null,G(t(pe),o=>(v(),b(l,{key:o.value,value:o.value,label:t(e)(o.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.icon"),path:"icon"},{default:i(()=>[n.iconType==="1"?(v(),b(g,{key:0,value:n.icon,"onUpdate:value":s[3]||(s[3]=o=>n.icon=o),placeholder:t(e)("page.manage.menu.form.icon"),class:"flex-1"},{suffix:i(()=>[n.icon?(v(),b(X,{key:0,icon:n.icon,class:"text-icon"},null,8,["icon"])):L("",!0)]),_:1},8,["value","placeholder"])):L("",!0),n.iconType==="2"?(v(),b(D,{key:1,value:n.icon,"onUpdate:value":s[4]||(s[4]=o=>n.icon=o),placeholder:t(e)("page.manage.menu.form.localIcon"),options:t(I)},null,8,["value","placeholder","options"])):L("",!0)]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.routeName"),path:"routeName"},{default:i(()=>[a(g,{value:n.routeName,"onUpdate:value":s[5]||(s[5]=o=>n.routeName=o),placeholder:t(e)("page.manage.menu.form.routeName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.routePath"),path:"routePath"},{default:i(()=>[a(g,{value:n.routePath,"onUpdate:value":s[6]||(s[6]=o=>n.routePath=o),placeholder:t(e)("page.manage.menu.form.routePath")},null,8,["value","placeholder"])]),_:1},8,["label"]),F.value?(v(),b(u,{key:0,label:t(e)("page.manage.menu.layout"),path:"layout"},{default:i(()=>[a(D,{value:n.layout,"onUpdate:value":s[7]||(s[7]=o=>n.layout=o),options:k,placeholder:t(e)("page.manage.menu.form.layout")},null,8,["value","placeholder"])]),_:1},8,["label"])):L("",!0),z.value?(v(),b(u,{key:1,label:t(e)("page.manage.menu.page"),path:"page"},{default:i(()=>[a(D,{value:n.page,"onUpdate:value":s[8]||(s[8]=o=>n.page=o),options:W.value,placeholder:t(e)("page.manage.menu.form.page")},null,8,["value","options","placeholder"])]),_:1},8,["label"])):L("",!0),a(u,{label:t(e)("page.manage.menu.menuStatus"),path:"status"},{default:i(()=>[a(r,{value:n.status,"onUpdate:value":s[9]||(s[9]=o=>n.status=o)},{default:i(()=>[(v(!0),x(q,null,G(t(me),o=>(v(),b(l,{key:o.value,value:o.value,label:t(e)(o.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.hideInMenu"),path:"hideInMenu"},{default:i(()=>[a(r,{value:n.hideInMenu,"onUpdate:value":s[10]||(s[10]=o=>n.hideInMenu=o)},{default:i(()=>[a(l,{value:"",label:t(e)("common.yesOrNo.yes")},null,8,["label"]),a(l,{value:!1,label:t(e)("common.yesOrNo.no")},null,8,["label"])]),_:1},8,["value"])]),_:1},8,["label"]),a(u,{label:t(e)("page.manage.menu.order"),path:"order"},{default:i(()=>[a(y,{value:n.order,"onUpdate:value":s[11]||(s[11]=o=>n.order=o),placeholder:t(e)("page.manage.menu.form.order")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"])}}});function O(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!xe(p)}const Je=te({name:"manage_menu",__name:"index",setup(p){const f=Ae(),{bool:m,setTrue:_,setFalse:h}=Me(),S=V(null),{columns:B,columnChecks:w,data:E,loading:P,pagination:n,getData:T}=ge({apiFn:ve,columns:()=>[{type:"selection",align:"center",width:48},{key:"id",title:e("page.manage.menu.id"),align:"center"},{key:"menuType",title:e("page.manage.menu.menuType"),align:"center",width:80,render:l=>{const r={1:"default",2:"primary"},u=e(fe[l.menuType]);return a(H,{type:r[l.menuType]},O(u)?u:{default:()=>[u]})}},{key:"menuName",title:e("page.manage.menu.menuName"),align:"center",minWidth:120,render:l=>{const{i18nKey:r,menuName:u}=l,g=r?e(r):u;return a("span",null,[g])}},{key:"icon",title:e("page.manage.menu.icon"),align:"center",width:60,render:l=>{const r=l.iconType==="1"?l.icon:void 0,u=l.iconType==="2"?l.icon:void 0;return a("div",{class:"flex-center"},[a(X,{icon:r,localIcon:u,class:"text-icon"},null)])}},{key:"routeName",title:e("page.manage.menu.routeName"),align:"center",minWidth:120},{key:"routePath",title:e("page.manage.menu.routePath"),align:"center",minWidth:120},{key:"status",title:e("page.manage.menu.menuStatus"),align:"center",width:80,render:l=>{if(l.status===null)return null;const r={1:"success",2:"warning"},u=e(ye[l.status]);return a(H,{type:r[l.status]},O(u)?u:{default:()=>[u]})}},{key:"hideInMenu",title:e("page.manage.menu.hideInMenu"),align:"center",width:80,render:l=>{const r=l.hideInMenu?"Y":"N",u={Y:"error",N:"default"},g=e(ne[r]);return a(H,{type:u[r]},O(g)?g:{default:()=>[g]})}},{key:"parentId",title:e("page.manage.menu.parentId"),width:90,align:"center"},{key:"order",title:e("page.manage.menu.order"),align:"center",width:60},{key:"operate",title:e("common.operate"),align:"center",width:230,render:l=>{let r,u;return a("div",{class:"flex-center justify-end gap-8px"},[l.menuType==="1"&&a($,{type:"primary",ghost:!0,size:"small",onClick:()=>A(l)},O(r=e("page.manage.menu.addChildMenu"))?r:{default:()=>[r]}),a($,{type:"primary",ghost:!0,size:"small",onClick:()=>Y(l)},O(u=e("common.edit"))?u:{default:()=>[u]}),a(be,{onPositiveClick:()=>W(l.id)},{default:()=>e("common.confirmDelete"),trigger:()=>{let g;return a($,{type:"error",ghost:!0,size:"small"},O(g=e("common.delete"))?g:{default:()=>[g]})}})])}}]}),{checkedRowKeys:N,onBatchDeleted:j,onDeleted:J}=_e(E,T),I=V("add");function F(){I.value="add",_()}async function z(){console.log(N.value),j()}function W(l){console.log(l),J()}const k=V(null);function Y(l){I.value="edit",k.value={...l},_()}function A(l){I.value="addChild",k.value={...l},_()}const M=V([]);async function c(){const{data:l}=await Ne();M.value=l||[]}function s(){c()}return s(),(l,r)=>{const u=he,g=Te,D=Ve;return v(),x("div",{ref_key:"wrapperRef",ref:S,class:"flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},[a(D,{title:t(e)("page.manage.menu.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":i(()=>[a(u,{columns:t(w),"onUpdate:columns":r[0]||(r[0]=y=>K(w)?w.value=y:null),"disabled-delete":t(N).length===0,loading:t(P),onAdd:F,onDelete:z,onRefresh:t(T)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:i(()=>[a(g,{"checked-row-keys":t(N),"onUpdate:checkedRowKeys":r[1]||(r[1]=y=>K(N)?N.value=y:null),columns:t(B),data:t(E),size:"small","flex-height":!t(f).isMobile,"scroll-x":1088,loading:t(P),"row-key":y=>y.id,remote:"",pagination:t(n),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(qe,{visible:t(m),"onUpdate:visible":r[2]||(r[2]=y=>K(m)?m.value=y:null),"operate-type":I.value,"row-data":k.value,"all-pages":M.value,onSubmitted:t(T)},null,8,["visible","operate-type","row-data","all-pages","onSubmitted"])]),_:1},8,["title"])],512)}}});export{Je as default};
